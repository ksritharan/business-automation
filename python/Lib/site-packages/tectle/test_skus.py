import logging
logger = logging.getLogger()

skus = [
		'AE900001WT',
		'AG480001WT',
		'AK000001WT',
		'AE900001KT',
		'AG480001KT',
		'AK000001KT',
		'AE900001BT',
		'AG480001BT',
		'AK000001BT',
		'AE900001RT',
		'AG480001RT',
		'AK000001RT',
		'PD750001WTM',
		'PD750001KTM',
		'PD750001BTM',
		'PD750001RTM',
		'PH000001WTM',
		'PH000001KTM',
		'PH000001BTM',
		'PH000001RTM',
		'PK000001WTM',
		'PK000001KTM',
		'PK000001BTM',
		'PK000001RTM',
		'PD750002WTM',
		'PD750002KTM',
		'PD750002BTM',
		'PD750002RTM',
		'PH000002WTM',
		'PH000002KTM',
		'PH000002BTM',
		'PH000002RTM',
		'PK000002WTM',
		'PK000002KTM',
		'PK000002BTM',
		'PK000002RTM',
		'PD750003WTM',
		'PD750003KTM',
		'PD750003BTM',
		'PD750003RTM',
		'PH000003WTM',
		'PH000003KTM',
		'PH000003BTM',
		'PH000003RTM',
		'PK000003WTM',
		'PK000003KTM',
		'PK000003BTM',
		'PK000003RTM',
		'PD750004WTM',
		'PD750004KTM',
		'PD750004BTM',
		'PD750004RTM',
		'PH000004WTM',
		'PH000004KTM',
		'PH000004BTM',
		'PH000004RTM',
		'PK000004WTM',
		'PK000004KTM',
		'PK000004BTM',
		'PK000004RTM']

package_classes = {
    'Medium': {'id':1},
    'Large':  {'id':2},
    'XLarge': {'id':3},
    'Set':    {'id':4}
}

def get_product_data(sku, package_classes):
    #PD750001WTM
    data = {}
    data['sku'] = sku
    category = sku[0]
    if category == 'P':
        data['category'] = 'Planter'
    elif category == 'A':
        data['category'] = 'Accessory'
    else:
        logger.error(sku)
        logger.error(data['category'])
        raise Exception('Invalid category')
        
    size = ord(sku[1]) - ord('A') + 1
    size_decimal = float("0."+sku[2:4])
    data['size'] = size + size_decimal
    
    data['design_id'] = int(sku[4:8])

    if category == 'P':
        if data['design_id'] == 1:
            data['name'] = 'Fractal'
        elif data['design_id'] == 2:
            data['name'] = 'Opal'
        elif data['design_id'] == 3:
            data['name'] = 'Ripple'
        elif data['design_id'] == 4:
            data['name'] = 'Mica'
        elif data['design_id'] == 5:
            data['name'] = 'Pineapple'
        else:
            logger.error(sku)
            logger.error(data['design_id'])
            raise Exception('Invalid design_id')
    elif category == 'A':
        data['name'] = 'WaterPlate'
    
    color = sku[8:9]
    if color == 'W':
        data['color'] = 'White'
    elif color == 'B':
        data['color'] = 'Blue'
    elif color == 'K':
        data['color'] = 'Black'
    elif color == 'R':
        data['color'] = 'Red'
    else:
        logger.error(sku)
        logger.error(data['color'])
        raise Exception('Invalid color')
        
    if category == 'P':
        bottom = sku[10]
        if bottom == 'M':
            data['bottom'] = 'Mesh'
        elif bottom == 'S':
            data['bottom'] = 'Sealed'
        else:
            logger.error(sku)
            logger.error(data['bottom'])
            raise Exception('Invalid bottom')  
    else:
        data['bottom'] = ''
    
    if category == 'A':
        data['package_class_id'] = 'NULL'
    else:
        if data['size'] < 5:
            data['package_class_id'] = package_classes['Medium']['id']
        elif data['size'] < 9:
            data['package_class_id'] = package_classes['Large']['id']
        elif data['size']:
            data['package_class_id'] = package_classes['XLarge']['id']

    return data

if __name__ == '__main__':
    for sku in skus:
        data = get_product_data(sku)
        print(sku, data['category'], data['name'], data['bottom'], data['package_class_id'], data['color'])